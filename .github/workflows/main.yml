name: éƒ¨ç½² xget

on:
  # 1. è‡ªåŠ¨è§¦å‘ï¼šæ¨é€åˆ° main åˆ†æ”¯æ—¶ï¼ˆå¿½ç•¥æ–‡æ¡£ç­‰æ–‡ä»¶ï¼‰
  push:
    branches: [main]
    paths-ignore:
      - '**/*.md'
      - 'LICENSE'
      - '.gitignore'
      - 'README.md'
  # 2. æ‰‹åŠ¨è§¦å‘ï¼šåœ¨ Actions é¡µé¢ç‚¹å‡»è¿è¡Œ
  workflow_dispatch:

jobs:
  deploy:
    runs-on: ubuntu-latest
    env:
      # ä½¿ç”¨æ‚¨ä¹‹å‰å·²ç»é…ç½®å¥½çš„ Secrets
      CLOUDFLARE_ACCOUNT_ID: ${{ secrets.CLOUDFLARE_ACCOUNT_ID }}
      CLOUDFLARE_API_TOKEN: ${{ secrets.CLOUDFLARE_API_TOKEN }}

    steps:
      - name: æ£€å‡ºä»£ç 
        uses: actions/checkout@v4

      - name: éƒ¨ç½²åˆ° Cloudflare
        # è¿™é‡Œæ˜¯æ ¸å¿ƒéƒ¨ç½²å‘½ä»¤ï¼Œè¯·æ ¹æ® xget é¡¹ç›®çš„å®é™…éƒ¨ç½²è¦æ±‚å¡«å†™
        run: |
          echo "ğŸš€ å¼€å§‹éƒ¨ç½² xget é¡¹ç›®..."
          # ç¤ºä¾‹ï¼šå¦‚æœä½¿ç”¨ wrangler éƒ¨ç½²ï¼Œè¯·å–æ¶ˆä¸‹ä¸€è¡Œçš„æ³¨é‡Šå¹¶ä¿å­˜
          # npx wrangler deploy
          # å¦‚æœæ‚¨çš„é¡¹ç›®éœ€è¦å…ˆå®‰è£…ä¾èµ–å’Œæ„å»ºï¼Œå¯ä»¥å‚è€ƒä»¥ä¸‹æ ¼å¼ï¼š
          # npm install
          # npm run build
          # npx wrangler deploy
